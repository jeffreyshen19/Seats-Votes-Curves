var margin={top:40,right:20,bottom:60,left:60},red="#D64541",blue="#446CB3";function drawCurve(t){var e=d3.select(".body").node().offsetWidth-margin.left-margin.right,a=500-margin.top-margin.bottom,r=document.getElementById("year-selecter"),s=r.options[r.selectedIndex].value,n=document.getElementById("toggle-eg-band").checked;d3.selectAll(".graph").classed("hidden",!0).classed("active",!1);var o,l=d3.scaleLinear().range([0,e]).domain([0,100]),i=d3.scaleLinear().range([a,0]).domain([0,100]),d=d3.select("#"+t).select(".tooltip"),c=d3.select("#"+t).node().dataset;d3.select("#"+t).select("svg").selectAll("*").remove();var u=d3.select("#"+t).classed("hidden",!1).classed("active",!0).select("svg").attr("width",e+margin.left+margin.right).attr("height",a+margin.top+margin.bottom).on("mouseover",function(t){}).on("mousemove",function(t){(o=l.invert(d3.mouse(this)[0]-margin.left).toFixed(2))<0||o>100?d.classed("hidden",!0):d.classed("hidden",!1).html("At "+o+"% of vote:<br><br>").style("left",d3.mouse(this)[0]+20+"px").style("top",a-30+"px")}).on("mouseout",function(t){d.classed("hidden",!0)}).append("g").attr("transform","translate("+margin.left+","+margin.top+")");u.append("g").attr("transform","translate(0,"+a+")").call(d3.axisBottom(l).ticks(5).tickFormat(function(t){return t+"%"})),u.append("text").attr("transform","translate("+e/2+" ,"+(a+margin.top+10)+")").attr("class","axis-label").text("Percentage of Vote"),u.append("text").attr("transform","translate("+e/2+" ,-20)").attr("class","axis-label").text("Seats-Votes Curve for "+c.state+" in "+s),u.append("g").call(d3.axisLeft(i).ticks(5).tickFormat(function(t){return t+"%"})),u.append("text").attr("transform","rotate(-90)").attr("y",0-margin.left).attr("x",0-a/2).attr("dy","1em").attr("class","axis-label").text("Percentage of Seats"),d3.csv("../data/seats-votes/"+s+"/"+t+".csv",function(t,e){e.forEach(function(t){t.votes=parseFloat(t.votes),t.seatsR=parseFloat(t.seatsR),t.seatsD=parseFloat(t.seatsD)});var a=d3.line().x(function(t){return l(t.votes)}).y(function(t){return i(t.seatsR)}),r=d3.line().x(function(t){return l(t.votes)}).y(function(t){return i(t.seatsD)});u.append("path").data([e]).style("stroke",red).attr("class","line").attr("d",a),u.append("path").data([e]).style("stroke",blue).attr("class","line").attr("d",r),u.append("line").attr("x1",function(t){return l(0)}).attr("y1",function(t){return i(50)}).attr("x2",function(t){return l(100)}).attr("y2",function(t){return i(50)}).style("stroke","black").style("stroke-width","1").style("stroke-dasharray","5,5"),u.append("line").attr("x1",l(50)).attr("y1",i(0)).attr("x2",l(50)).attr("y2",i(100)).style("stroke","black").style("stroke-width","1").style("stroke-dasharray","5,5"),n&&u.append("polyline").attr("points",l(17)+","+i(0)+" "+l(33)+","+i(0)+" "+l(83)+","+i(100)+" "+l(67)+","+i(100)).style("fill","black").style("fill-opacity","0.3")})}function redrawCurves(){drawCurve(d3.select(".active").attr("id"))}drawCurve("AL");