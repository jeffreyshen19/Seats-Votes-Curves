var margin={top:40,right:20,bottom:60,left:60},red="#D64541",blue="#446CB3",scoreData={2000:null,2002:null,2004:null,2006:null,2008:null,2010:null,2012:null,2014:null,2016:null};function drawCurve(t){var e=d3.select(".body").node().offsetWidth-margin.left-margin.right,a=500-margin.top-margin.bottom,r=document.getElementById("year-selecter"),s=r.options[r.selectedIndex].value,n=document.getElementById("toggle-eg-band").checked;d3.selectAll(".graph").classed("hidden",!0).classed("active",!1);var o,i=d3.scaleLinear().range([0,e]).domain([0,100]),l=d3.scaleLinear().range([a,0]).domain([0,100]),c=d3.select("#"+t).select(".tooltip"),p=d3.select("#"+t).node().dataset;d3.select("#"+t).select("svg").selectAll("*").remove();var m=d3.select("#"+t).classed("hidden",!1).classed("active",!0).select("svg").attr("width",e+margin.left+margin.right).attr("height",a+margin.top+margin.bottom).on("mouseover",function(t){}).on("mousemove",function(t){(o=i.invert(d3.mouse(this)[0]-margin.left).toFixed(2))<0||o>100?c.classed("hidden",!0):c.classed("hidden",!1).html("At "+o+"% of vote:<br><br>").style("left",d3.mouse(this)[0]+20+"px").style("top",a-30+"px")}).on("mouseout",function(t){c.classed("hidden",!0)}).append("g").attr("transform","translate("+margin.left+","+margin.top+")");m.append("g").attr("transform","translate(0,"+a+")").call(d3.axisBottom(i).ticks(5).tickFormat(function(t){return t+"%"})),m.append("text").attr("transform","translate("+e/2+" ,"+(a+margin.top+10)+")").attr("class","axis-label").text("Percentage of Vote"),m.append("text").attr("transform","translate("+e/2+" ,-20)").attr("class","axis-label").text("Seats-Votes Curve for "+p.state+" in "+s),m.append("g").call(d3.axisLeft(l).ticks(5).tickFormat(function(t){return t+"%"})),m.append("text").attr("transform","rotate(-90)").attr("y",0-margin.left).attr("x",0-a/2).attr("dy","1em").attr("class","axis-label").text("Percentage of Seats"),d3.csv("../data/seats-votes/"+s+"/"+t+".csv",function(e,a){a.forEach(function(t){t.votes=parseFloat(t.votes),t.seatsR=parseFloat(t.seatsR),t.seatsD=parseFloat(t.seatsD)});var r=d3.line().x(function(t){return i(t.votes)}).y(function(t){return l(t.seatsR)}),o=d3.line().x(function(t){return i(t.votes)}).y(function(t){return l(t.seatsD)});if(m.append("path").data([a]).style("stroke",red).attr("class","line").attr("d",r),m.append("path").data([a]).style("stroke",blue).attr("class","line").attr("d",o),m.append("line").attr("x1",function(t){return i(0)}).attr("y1",function(t){return l(50)}).attr("x2",function(t){return i(100)}).attr("y2",function(t){return l(50)}).style("stroke","black").style("stroke-width","1").style("stroke-dasharray","5,5"),m.append("line").attr("x1",i(50)).attr("y1",l(0)).attr("x2",i(50)).attr("y2",l(100)).style("stroke","black").style("stroke-width","1").style("stroke-dasharray","5,5"),n&&m.append("polyline").attr("points",i(17)+","+l(0)+" "+i(33)+","+l(0)+" "+i(83)+","+l(100)+" "+i(67)+","+l(100)).style("fill","black").style("fill-opacity","0.3"),null==scoreData[""+s])d3.csv("../data/seats-votes-scores/"+s+".csv",function(e,a){scoreData[""+s]=[],a.forEach(function(e){e.state==t&&m.append("text").attr("x",10).attr("y",10).append("svg:tspan").attr("x",10).attr("dy",0).text("Partisan bias: "+parseFloat(e.gk_bias).toFixed(2)+"%").append("svg:tspan").attr("x",10).attr("dy",20).text("Symmetry: "+parseFloat(e.symmetry).toFixed(2)+"%").append("svg:tspan").attr("x",10).attr("dy",20).text("Responsiveness: "+parseFloat(e.responsiveness).toFixed(2)+"%"),scoreData[""+s].push({state:e.state,gk_bias:parseFloat(e.gk_bias).toFixed(2),symmetry:parseFloat(e.symmetry).toFixed(2),responsiveness:parseFloat(e.responsiveness).toFixed(2)})})});else for(var c=0;c<scoreData[""+s].length;c++)if(d=scoreData[""+s][c],d.state==t){m.append("text").attr("x",10).attr("y",10).append("svg:tspan").attr("x",10).attr("dy",0).text("Partisan bias: "+d.gk_bias+"%").append("svg:tspan").attr("x",10).attr("dy",20).text("Symmetry: "+d.symmetry+"%").append("svg:tspan").attr("x",10).attr("dy",20).text("Responsiveness: "+d.responsiveness+"%");break}})}margin={top:40,right:20,bottom:60,left:60},red="#D64541",blue="#446CB3";function drawDemonstrationCurve(t){var e,a,r=d3.select("#"+t).node().dataset;r.half?(e=(d3.select(".section").node().offsetWidth-100)/2-margin.left-margin.right,a=d3.select("table").node().offsetHeight-margin.top-margin.bottom):(e=d3.select(".section").node().offsetWidth-100-margin.left-margin.right,a=300-margin.top-margin.bottom),r.height&&(a=parseInt(r.height)-margin.top-margin.bottom);var s,n=d3.scaleLinear().range([0,e]).domain([0,100]),o=d3.scaleLinear().range([a,0]).domain([0,100]),i=d3.select("#"+t).select(".tooltip");d3.select("#"+t).select("svg").selectAll("*").remove();var l=d3.select("#"+t).classed("hidden",!1).select("svg").attr("width",e+margin.left+margin.right).attr("height",a+margin.top+margin.bottom).on("mouseover",function(t){}).on("mousemove",function(t){(s=n.invert(d3.mouse(this)[0]-margin.left).toFixed(2))<0||s>100?i.classed("hidden",!0):i.classed("hidden",!1).html("At "+s+"% of vote:<br><br>").style("left",d3.mouse(this)[0]+20+"px").style("top",a-30+"px")}).on("mouseout",function(t){i.classed("hidden",!0)}).append("g").attr("transform","translate("+margin.left+","+margin.top+")");l.append("g").attr("transform","translate(0,"+a+")").call(d3.axisBottom(n).ticks(5).tickFormat(function(t){return t+"%"})),l.append("text").attr("transform","translate("+e/2+" ,"+(a+margin.top+10)+")").attr("class","axis-label").text("Percentage of Vote"),l.append("text").attr("transform","translate("+e/2+" ,-20)").attr("class","axis-label").text(r.caption?r.caption:"Seats-Votes Curve"),l.append("g").call(d3.axisLeft(o).ticks(5).tickFormat(function(t){return t+"%"})),l.append("text").attr("transform","rotate(-90)").attr("y",0-margin.left).attr("x",0-a/2).attr("dy","1em").attr("class","axis-label").text("Percentage of Seats"),d3.csv("../data/demo/"+t+".csv",function(t,e){if(e.forEach(function(t){t.votes=parseFloat(t.votes),t.seatsR=parseFloat(t.seatsR),t.seatsD=parseFloat(t.seatsD)}),r.dots)l.selectAll(".dot-rep").data(e).enter().append("circle").attr("class","dot-rep").style("fill",red).attr("cx",function(t){return n(t.votes)}).attr("cy",function(t){return o(t.seatsR)}).attr("r",5),l.selectAll(".dot-dem").data(e).enter().append("circle").attr("class","dot-dem").style("fill",blue).attr("cx",function(t){return n(t.votes)}).attr("cy",function(t){return o(t.seatsD)}).attr("r",5);else{var a=d3.line().x(function(t){return n(t.votes)}).y(function(t){return o(t.seatsR)}),s=d3.line().x(function(t){return n(t.votes)}).y(function(t){return o(t.seatsD)});l.append("path").data([e]).style("stroke",red).attr("class","line").attr("d",a),l.append("path").data([e]).style("stroke",blue).attr("class","line").attr("d",s)}l.append("line").attr("x1",function(t){return n(0)}).attr("y1",function(t){return o(50)}).attr("x2",function(t){return n(100)}).attr("y2",function(t){return o(50)}).style("stroke","black").style("stroke-width","1").style("stroke-dasharray","5,5"),l.append("line").attr("x1",n(50)).attr("y1",o(0)).attr("x2",n(50)).attr("y2",o(100)).style("stroke","black").style("stroke-width","1").style("stroke-dasharray","5,5")})}margin={top:40,right:20,bottom:60,left:60};function drawHistoricalCurve(t){var e=t.split("-")[1],a=t.split("-")[2],r=d3.select(".body").node().offsetWidth-margin.left-margin.right,s=500-margin.top-margin.bottom;d3.selectAll(".graph-historical-"+e).classed("hidden",!0).classed("active-historical",!1);var n,o=d3.scalePoint().range([0,r]),i=d3.scaleLinear().range([s,0]).domain([-100,100]),l=d3.select("#"+t).select(".tooltip"),d=d3.select("#"+t).node().dataset;d3.select("#"+t).select("svg").selectAll("*").remove();var c=d3.select("#"+t).classed("hidden",!1).classed("active-historical",!0).select("svg").attr("width",r+margin.left+margin.right).attr("height",s+margin.top+margin.bottom).on("mouseover",function(t){}).on("mousemove",function(t){(n=o.invert(d3.mouse(this)[0]-margin.left).toFixed(2))<0||n>100?l.classed("hidden",!0):l.classed("hidden",!1).html("At "+n+"% of vote:<br><br>").style("left",d3.mouse(this)[0]+20+"px").style("top",s-30+"px")}).on("mouseout",function(t){l.classed("hidden",!0)}).append("g").attr("transform","translate("+margin.left+","+margin.top+")");d3.csv("../data/historical-results/"+e+"/"+a+".csv",function(t,e){e.forEach(function(t){t.y=parseFloat(t.y)}),o.domain(e.map(function(t){return t.year})),c.append("g").attr("transform","translate(0,"+s+")").call(d3.axisBottom(o)),c.append("text").attr("transform","translate("+r/2+" ,"+(s+margin.top+10)+")").attr("class","axis-label").text("Year"),c.append("text").attr("transform","translate("+r/2+" ,-20)").attr("class","axis-label").text(d.title+" in "+d.state+" between 2000 - 2016"),c.append("g").call(d3.axisLeft(i).ticks(5).tickFormat(function(t){return t+"%"})),c.append("text").attr("transform","rotate(-90)").attr("y",0-margin.left).attr("x",0-s/2).attr("dy","1em").attr("class","axis-label").text(d.title);var a=d3.line().x(function(t){return o(t.year)}).y(function(t){return i(t.y)});c.append("path").data([e]).style("stroke","#2c3e50").attr("class","line").attr("d",a),c.append("line").attr("x1",function(t){return o("2000")}).attr("y1",function(t){return i(0)}).attr("x2",function(t){return o("2016")}).attr("y2",function(t){return i(0)}).style("stroke","black").style("stroke-width","1").style("stroke-dasharray","5,5")})}function redrawCurves(){drawCurve(d3.select(".active").attr("id")),drawHistoricalCurve(d3.select(".active-historical").attr("id"))}drawCurve("AL"),drawHistoricalCurve("historical-gk-AL"),drawHistoricalCurve("historical-responsiveness-AL"),drawHistoricalCurve("historical-symmetry-AL"),drawDemonstrationCurve("step-1"),drawDemonstrationCurve("step-2"),drawDemonstrationCurve("step-3"),drawDemonstrationCurve("step-4"),drawDemonstrationCurve("not-symmetric"),drawDemonstrationCurve("symmetric"),drawDemonstrationCurve("proportional"),drawDemonstrationCurve("incumbent-protection"),drawDemonstrationCurve("winner-take-all"),drawDemonstrationCurve("eg-optimized"),drawDemonstrationCurve("partisan-bias"),drawDemonstrationCurve("partisan-not-bias");